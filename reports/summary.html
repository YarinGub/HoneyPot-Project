<html><head><meta charset='utf-8'><title>Honeypot Report</title>

    <style>
      body { font-family: system-ui, Arial; margin:20px; background:#0b1220; color:#e6edf3;}
      h1{margin:0 0 10px;}
      .stats{margin:20px 0;padding:10px;background:#111a2e;border:1px solid #1d2a44;border-radius:8px;}
      table{border-collapse:collapse;width:100%;background:#0e1730;}
      th,td{border:1px solid #1d2a44;padding:8px;font-size:14px;}
      th{background:#101a36;}
      tr:hover td{background:#0f1a35;}
    </style>
    <script>setTimeout(()=>location.reload(),10000);</script>
    
</head><body>
<h1>ðŸ“Š Honeypot Activity Summary</h1>
<div class='stats'><h2>Summary Stats</h2>
<ul>
{% set trap_counts = {} %}
{% for e in events %}
  {% set t = e.trap_type %}
  {% set _ = trap_counts.update({t: trap_counts.get(t, 0) + 1}) %}
{% endfor %}
{% for t, count in trap_counts.items() %}
  <li>{{ t }}: <b>{{ count }}</b></li>
{% endfor %}
</ul>
</div>
<table>
  <tr><th>Timestamp</th><th>Trap</th><th>IP</th><th>Input</th></tr>
  {% for e in events %}
    <tr>
      <td>{{ e.time }}</td>
      <td>{{ e.trap_type }}</td>
      <td>{{ e.src_ip }}</td>
      <td>{{ e.input }}</td>
    </tr>
  {% endfor %}
</table></body></html>